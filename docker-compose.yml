version: '3.8'

services:

  release:
    image: johnnyhuy/actions-discord-git-webhook/release:latest
    build:
      context: .
      dockerfile: release.Dockerfile
    volumes:
      - ".:/app"
    working_dir: /app
    environment:
      - CONVENTIONAL_GITHUB_RELEASER_TOKEN

  publish:
    image: johnnyhuy/actions-discord-git-webhook/publish:latest
    command: python3 publish.py
    build:
      context: .
      dockerfile: publish.Dockerfile
    volumes:
      - ".:/app"
      - "~/.aws:/root/.aws"
    working_dir: /app
    environment:
      - AWS_DEFAULT_REGION=${AWS_DEFAULT_REGION}
      - BUILDKITE_TAG